!function(){var d=window,v=window.TapfiliateObject||"tap",r=d[v]&&d[v].q||[];if(!d[v]||!d[v].loaded){d[v]=function(t,e,n,o,i,r){var a=d[v][t];if("function"!=typeof a)throw'Function "'+t+'" not supported';a(e,n,o,i,r)},d[v].q=r,d[v].loaded=!0,d[v].baseUrl="https://frstre.com",d[v].baseUrlDepr="https://tapi.tapfiliate.com";var e,h;d[v].Tracking=d[v].Tracking||{},d[v].options=d[v].options||{};var k={},a=!1,s=new function(){var s={},l=0,u=[],c=[],p=!1,o=this;return this.addMethod=function(t){if(t.supported())return l++,s[t.key]=t,this},this.init=function(){var t=l;function e(){--t<=0&&(p=!0,function(){for(var t=u.length-1;0<=t;t--)o.read.apply(o,u[t]);for(var e=c.length-1;0<=e;e--)o.write.apply(o,c[e])}())}for(var n in s)"function"==typeof s[n].init?s[n].init(e):e()},this.read=function(t,e,o){if(p){var i=l,r=[],a={};for(var n in s){a[n]=setTimeout(c,2e3);try{s[n].read(t,c)}catch(t){}}}else u.push(arguments);function c(t,e,n){clearTimeout(a[n]),e&&e.constructor===Array?r=r.concat(e):r.push(e),0==--i&&o(null,r)}},this.write=function(t,e,n,o){p||c.push(arguments);var i=l;function r(t,e){0==--i&&"function"==typeof o&&o()}for(var a in s)s[a].write(t,e,n,r)},this.hasMethod=function(t){return void 0!==s[t]},this};t.prototype.supported=function(){return!0};var i=new t("1pCookie");i.read=function(t,e){for(var n=t+"=",o=document.cookie.split(";"),i=[],r=0;r<o.length;r++){var a=o[r].replace(/^\s+|\s+$/g,"");0===a.indexOf(n)&&i.push(a.substring(n.length,a.length))}return"function"==typeof e?e(null,i,this.key):i},i.write=function(t,e,n,o){n=n||{};var i=new Date;i.setTime(i.getTime()+31536e6);var r,a="expires="+i.toGMTString();if(n.cookie_domain)r="."+n.cookie_domain;else try{var c=window.location.href.match(/(?:https?:\/\/)?(?:www\.)?(.*?)\//);r="."+c[c.length-1]}catch(t){}var s=t+"="+e+"; "+a+"; path=/";s+=void 0!==r?"; domain="+r:"",document.cookie=s,o()};var c=new t("localStorage");c.supported=function(){return"undefined"!=typeof localStorage},c.read=function(t,e){e(null,localStorage.getItem(t),this.key)},c.write=function(t,e,n,o){o(null,localStorage.setItem(t,e))},(w.prototype=new t).supported=function(){return"undefined"!=typeof postMessage},w.prototype.handleEvent=function(t){if(t.origin===this.options.url){var e;try{e=JSON.parse(t.data)}catch(t){}e&&e.callback&&this.callbacks[e.callback](e.value)}},w.prototype.init=function(t){var e=document.createElement("IFRAME");e.setAttribute("src",this.options.url+"/?"+this.options.beaconVersion),e.style.width="1px",e.style.height="1px",e.style.display="none",u(window,"message",this);var n=this;u(e,"load",function(){n.beacon=e.contentWindow,t()}),setTimeout(function(){document.body.appendChild(e)},0)},w.prototype.post=function(t){this.beacon.postMessage(t,this.options.url)},w.prototype.read=function(t,e){var n=this;this.callbacks.get=function(t){e(null,t,n.key)};var o={action:"getAll",key:t};this.post(JSON.stringify(o))},w.prototype.write=function(t,e,n,o){this.callbacks.set=function(t){o(null,t)};var i={action:"set",key:t,value:e};this.post(JSON.stringify(i))},d[v].Create=d[v].Create||{},d[v].Create.calls=d[v].Create.calls||[],d[v].Click=d[v].Click||{},d[v].Click.q=d[v].Click.q||[],d[v].Click.calls=d[v].Click.calls||[],d[v].Click.track=function(t,e,n,o){if(window.self===window.top){var i,r,a,c,s;if(null===(n=n||{}).referral_code_param&&void 0===n.referral_code||(i=n.referral_code,r=n.referral_code_param,s=r,a=(c=i)||0===c?c:(s=s||"ref",m()[s])),d[v].Click.calls.push(n),!(t&&e||a))return _("No tracking parameters",n,o);var l=m(),u=null;for(var p in l)"tm_"===p.slice(0,3)&&((u=u||{})[p.slice(3,p.length)]=l[p]);var f={data:{acc:h,aid:t,sid:e,callback:o,options:n,pm:u,ref:document.referrer||null,cup:document.location.href||null,int:k.integration||null}};a&&(f.data.refc=a),d[v].Click.q.push(f),y()}},d[v].Click.get=function(i){f(d[v].baseUrl+"/event/"+i+"/",{},"GET",function(t,e){var n=t.response||t.responseText;if(e&&n){var o=JSON.parse(n);if(o.vid)return s.write("tap_vid",o.vid),void g([o.vid])}return _("Failed to get click",i)})},d[v].Click.flushQueue=function(){d[v].Click.q.reverse();for(var t=d[v].Click.q.length-1;0<=t;t--){var i=d[v].Click.q[t].data,e=b();if(i.aid&&i.sid||i.refc){var n={acc:i.acc,aid:i.aid,sid:i.sid,pm:i.pm,ref:i.ref,cup:i.cup,refc:i.refc,int:i.int};e&&s.hasMethod("3pCookie")&&(n.vids=e),f(d[v].baseUrl+"/event/",n,null,function(t,e){var n=t.response||t.responseText;if(e&&n){var o=JSON.parse(n);if(o.vid)return s.write("tap_vid",o.vid,i.options),g([o.vid]),void("function"==typeof i.callback&&(1==i.options.always_callback?i.callback(null,o):i.callback(o)))}return _("Tracking request failed",i.options,i.callback)})}d[v].Click.q.splice(t,1)}},d[v].Conversion=d[v].Conversion||{},d[v].Conversion.q=d[v].Conversion.q||[],d[v].Conversion.calls=d[v].Conversion.calls||[],d[v].Conversion.flushQueue=function(){d[v].Conversion.q.reverse();for(var t=d[v].Conversion.q.length-1;0<=t;t--){var o=d[v].Conversion.q[t].data,e=d[v].Conversion.q[t].type,n=void 0!==d[v].Conversion.q[t].vid?d[v].Conversion.q[t].vid:b();if(!(o.acc&&n||o.options.attribution_id||o.options.coupons&&o.options.coupons.length||o.options.customer_id))return _("Non-tracked visitor",o.options,o.callback);var i,r=d[v].baseUrlDepr+"/conversions/";if("single"==e)i={acc:o.acc,vid:n,tid:o.tid,tam:o.tam,options:o.options,ct:o.ct,int:o.int};else{if("multi"!=e)return _("Missing request type",o.options,o.callback);i={acc:o.acc,vid:n,tid:o.tid,options:o.options,com:o.com,int:o.int}}f(r,i,"POST",function(t,e){if(!e)return _("Conversion denied",o.options,o.callback);var n;try{n=JSON.parse(t.response)}catch(t){return _("Conversion denied",o.options,o.callback)}"function"==typeof o.callback&&(1==o.options.always_callback?o.callback(null,n):o.callback(n,"success"))}),n&&n.length&&d[v].Conversion.q.splice(t,1)}},d[v].Customer=d[v].Customer||{},d[v].Customer.q=d[v].Customer.q||[],d[v].Customer.calls=d[v].Customer.calls||[],d[v].Customer.flushQueue=function(){d[v].Customer.q.reverse();for(var t=d[v].Customer.q.length-1;0<=t;t--){var o=d[v].Customer.q[t].data,e=void 0!==d[v].Customer.q[t].vid?d[v].Customer.q[t].vid:b();if(!(o.acc&&e||o.options.coupons&&o.options.coupons.length))return _("Non-tracked visitor",o.options,o.callback);f(d[v].baseUrlDepr+"/customers/",{acc:o.acc,vid:e,tid:o.tid,options:o.options,sta:o.sta},"POST",function(t,e){if(!e)return _("Customer denied",o.options,o.callback);var n;try{n=JSON.parse(t.response)}catch(t){return _("Customer denied",o.options,o.callback)}"function"==typeof o.callback&&(1==o.options.always_callback?o.callback(null,n):o.callback(n,"success"))}),e&&e.length&&d[v].Customer.q.splice(t,1)}},d[v].create=function(t,e,n){var o;h=t,k=function(){for(var t={},e=0;e<arguments.length;e+=1)for(var n=arguments[e],o=Object.keys(n),i=0;i<o.length;i+=1)t[o[i]]=n[o[i]];return t}(k,e||{}),o=k,s.hasMethod("1pcookie")||s.addMethod(i),s.hasMethod("localStorage")||s.addMethod(c),o.include_methods&&-1<o.include_methods.indexOf("3p")&&!s.hasMethod("3pCookie")&&s.addMethod(new w("3pCookie",{url:"https://b.frstre.com",beaconVersion:"v1.4"})),s.init(),s.read("tap_vid",{},function(t,e){g(e),y(),"function"==typeof n&&n()}),d[v].Create.calls.push({accountId:t,options:e})},d[v].detect=function(t,e){t=t||{},this.urlParams=m();var n=this.urlParams[t.asset_param||"tap_a"],o=this.urlParams[t.source_param||"tap_s"];d[v].Click.track(n,o,t,e);var i=this.urlParams[t.click_id_param||"click_id"];void 0!==i&&d[v].Click.get(i)},d[v].click=function(t,e,n){var o=t||{};e=e||{};var i=o.tap_a||o.asset_id,r=o.tap_s||o.source_id;void 0!==o.referral_code&&(e.referral_code=o.referral_code),d[v].Click.track(i,r,e,n)},d[v].conversion=function(t,e,n,o,i){if(window.self===window.top){var r={type:"single",data:{acc:h,tid:t=t||null,tam:e=void 0!==e?e:null,options:n=n||{},ct:o,callback:i,int:k.integration||null}};d[v].Conversion.q.push(r),y(),d[v].Conversion.calls.push({type:"single",tid:t,tam:e,options:n,ct:o})}};var o=function(t,e,n,o){if(window.self===window.top){var i={data:{acc:h,tid:t=t||null,sta:o,options:e=e||{},callback:n,int:k.integration||null}};d[v].Customer.q.push(i),y(),d[v].Customer.calls.push({tid:t,options:e})}};d[v].customer=function(t,e,n){o(t,e,n,"customer")},d[v].trial=function(t,e,n){o(t,e,n,"trial")},d[v].lead=function(t,e,n){o(t,e,n,"lead")},d[v].transactionMulti=function(t,e,n,o){d[v].conversionMulti(t,e,n,o)},d[v].conversionMulti=function(t,e,n,o){var i={type:"multi",data:{acc:h,tid:t,com:n,options:e=e||{},callback:o,int:k.integration||null}};d[v].Conversion.q.push(i),y(),d[v].Conversion.calls.push({type:"multi",tid:t,options:e,com:n})},d[v].getTrackingId=function(o,i){if(s.hasMethod("3pCookie"))throw"getTrackingId not supported with 3rd party cookies enabled";o=o||{};var r=0;!function n(){setTimeout(function(){if(r++,!C())return n();if(!(200<r)){var t=b(),e=null;t&&(e=t.join("__")),"function"==typeof i&&(1==o.always_callback?i(null,e):i(e))}},100)}()},d[v].detectClick=function(t){d[v].detect({referral_code_param:null},t)},d[v].transaction=function(t,e,n,o,i){d[v].conversion(t,e,n,o,i)};try{a=m().tap_test||i.read("tap_debug").length}catch(t){a=!1}var l=function(){i.write("tap_debug","true",{},function(){});var t=document.createElement("script");t.setAttribute("src","https://script.tapfiliate.com/tapfiliate-debug.js"),t.setAttribute("async",!0),document.body.appendChild(t)};!function(){if(a){var t=!1;function e(){!t&&-1<["interactive","complete"].indexOf(document.readyState)&&(t=!0,l())}return document.addEventListener("readystatechange",e),window.addEventListener("load",e),e()}var n;r.reverse();for(var o=r.length-1;0<=o;o--){var i=r[o][0];"create"===i&&n||(d[v].apply(window,r[o]),r.splice(o,1),"create"===i&&(n=!0))}}()}function u(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent&&t.attachEvent("on"+e,n)}function p(t,e,n){var o,i,r,a;if(a=/\[\]$/,e instanceof Array)for(i=0,r=e.length;i<r;i++)a.test(t)?n(t,e[i]):p(t+"["+("object"==typeof e[i]?i:"")+"]",e[i],n);else if("object"==typeof e)for(o in e)p(t+"["+o+"]",e[o],n);else n(t,e)}function f(t,e,n,o){(e=function(t){for(var e in t)void 0===t[e]&&delete t[e];return t}(e)).sv="tap-v3"+(s.hasMethod("3pCookie")?"-3p":"");var i=t+"?"+function(t){var e,n,o,i,r;if(n=[],r=/%20/g,o=function(t,e){e="function"==typeof e?e():null===e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)},t instanceof Array)for(i in t)o(i,t[i]);else for(e in t)p(e,t[e],o);return n.join("&").replace(r,"+")}(e),r="GET"===(n=n||(2083<i.length?"POST":"GET"))?i:t;e="POST"===n?JSON.stringify(e):null;var a=new XMLHttpRequest;if("withCredentials"in a)a.open(n,r,!0);else{if("undefined"==typeof XDomainRequest)return;var c=function(){};(a=new XDomainRequest).onerror=c,a.ontimeout=c,a.onprogress=c,a.onload=function(){"function"==typeof o&&o(a,!0)},a.timeout=9e3,a.open(n,r)}a.onreadystatechange=function(){if(a.readyState<4)return;if(200!==a.status)return void("function"==typeof o&&o(a,!1));4===a.readyState&&"function"==typeof o&&o(a,!0)},a.send(e)}function m(){var t={},e=function(t){return decodeURIComponent(t.replace(/\+/g," "))},n=location.search.substring(1),o=location.hash.substring(1),i=n.split("&");for(var r in i=i.concat(o.split("&")))if(i.hasOwnProperty(r)){var a=i[r].toString().split("=");1<a.length&&(t[e(a[0])]=e(a[1]))}return t}function C(){return e}function y(){C()&&!a&&(d[v].Click.flushQueue(),d[v].Conversion.flushQueue(),d[v].Customer.flushQueue())}function g(t){d[v].vid=t.sort()[0],d[v].vids=t,e=!0}function b(){if(d[v].vids){for(var t=[],e=d[v].vids.length-1;0<=e;e--){var n=d[v].vids[e];n&&-1===t.indexOf(n)&&t.push(n)}if(t.length)return t}}function t(t,e){return this.key=t,this.options=e||{},this.setOption=function(t,e){this.options[t]=e},this}function w(){return this.constructor.apply(this,arguments),this.callbacks={},this}function _(t,e,n){if("function"==typeof n)return 1==e.always_callback?n(t):!0===e.alwaysFireCb?n(null,"error",t):void 0}}();